import{r as p,j as e,x as h,ag as B,an as O,ay as w,w as y,ax as U,ak as z,G as H,ao as q}from"./ui-ChaMvfLm.js";import{u as G,B as j,C as d,a as o,I as K,S as f,b as v,c as C,d as T,e as l,f as W,g as X,T as $,h as J,i as b,j as c,k as Q,l as r,n as S}from"./index-BwfpsJi4.js";import"./vendor-D3F3s8fL.js";import"./supabase-BXl3LOEh.js";function ae(){const{state:R,dispatch:i}=G(),{reviews:n,filters:E,loading:L}=R,a=E.reviews,g=p.useMemo(()=>n.filter(s=>{const t=a.searchTerm===""||s.patientName.toLowerCase().includes(a.searchTerm.toLowerCase())||s.service.toLowerCase().includes(a.searchTerm.toLowerCase())||s.content.toLowerCase().includes(a.searchTerm.toLowerCase())||s.doctorName.toLowerCase().includes(a.searchTerm.toLowerCase()),u=a.status==="all"||s.status===a.status,N=a.rating==="all"||s.rating.toString()===a.rating;return t&&u&&N}).sort((s,t)=>new Date(t.createdAt).getTime()-new Date(s.createdAt).getTime()),[n,a]),m=p.useMemo(()=>{const s=n.length,t=n.filter(x=>x.status==="승인대기").length,u=n.filter(x=>x.status==="승인완료").length,N=s>0?n.reduce((x,_)=>x+_.rating,0)/s:0;return{total:s,pending:t,approved:u,avgRating:Math.round(N*10)/10}},[n]),A=s=>({승인대기:"bg-orange-100 text-orange-800",승인완료:"bg-green-100 text-green-800",승인거부:"bg-red-100 text-red-800"})[s]||"bg-gray-100 text-gray-800",D=s=>e.jsxs("div",{className:"flex items-center space-x-1",children:[[1,2,3,4,5].map(t=>e.jsx(h,{className:`w-4 h-4 ${t<=s?"text-yellow-400 fill-current":"text-gray-300"}`},t)),e.jsxs("span",{className:"text-sm text-gray-600 ml-1",children:["(",s,")"]})]}),F=s=>{i({type:"UPDATE_FILTERS",payload:{section:"reviews",filters:{searchTerm:s}}})},I=s=>{i({type:"UPDATE_FILTERS",payload:{section:"reviews",filters:{status:s}}})},k=s=>{i({type:"UPDATE_FILTERS",payload:{section:"reviews",filters:{rating:s}}})},M=s=>{i({type:"OPEN_MODAL",payload:{type:"review-view",data:s}})},P=s=>{i({type:"APPROVE_REVIEW",payload:s})},V=s=>{i({type:"OPEN_MODAL",payload:{type:"review-reject",data:s}})};return L?e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3 mb-4"}),e.jsx("div",{className:"h-64 bg-gray-200 rounded"})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-white rounded-2xl shadow-lg border border-yellow-100 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold bg-gradient-to-r from-yellow-600 to-orange-600 bg-clip-text text-transparent flex items-center",children:[e.jsx(h,{className:"w-6 h-6 mr-3 text-yellow-600"}),"후기 관리"]}),e.jsx("p",{className:"text-gray-600 mt-2",children:"고객 후기를 승인하고 관리하세요"})]}),e.jsx("div",{className:"flex items-center space-x-3",children:e.jsxs(j,{variant:"outline",className:"border-yellow-200 hover:bg-yellow-50",children:[e.jsx(B,{className:"w-4 h-4 mr-2"}),"엑셀 내보내기"]})})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(d,{className:"bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200",children:e.jsx(o,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-blue-700 font-medium",children:"전체 후기"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-800",children:[m.total,"건"]})]}),e.jsx(O,{className:"w-8 h-8 text-blue-600"})]})})}),e.jsx(d,{className:"bg-gradient-to-br from-orange-50 to-orange-100 border-orange-200",children:e.jsx(o,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-orange-700 font-medium",children:"승인 대기"}),e.jsxs("p",{className:"text-2xl font-bold text-orange-800",children:[m.pending,"건"]})]}),e.jsx(w,{className:"w-8 h-8 text-orange-600"})]})})}),e.jsx(d,{className:"bg-gradient-to-br from-green-50 to-green-100 border-green-200",children:e.jsx(o,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-green-700 font-medium",children:"승인 완료"}),e.jsxs("p",{className:"text-2xl font-bold text-green-800",children:[m.approved,"건"]})]}),e.jsx(y,{className:"w-8 h-8 text-green-600"})]})})}),e.jsx(d,{className:"bg-gradient-to-br from-yellow-50 to-yellow-100 border-yellow-200",children:e.jsx(o,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-yellow-700 font-medium",children:"평균 평점"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("p",{className:"text-2xl font-bold text-yellow-800",children:m.avgRating}),e.jsx(h,{className:"w-5 h-5 text-yellow-600 fill-current"})]})]}),e.jsx(U,{className:"w-8 h-8 text-yellow-600"})]})})})]}),e.jsx(d,{className:"shadow-lg border-0 bg-white",children:e.jsx(o,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-stretch md:items-center space-y-4 md:space-y-0 md:space-x-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(z,{className:"w-4 h-4 absolute left-3 top-3.5 text-gray-400"}),e.jsx(K,{placeholder:"환자명, 치료내용, 의료진으로 검색...",value:a.searchTerm,onChange:s=>F(s.target.value),className:"pl-10 border-yellow-200 focus:ring-yellow-500 focus:border-yellow-500"})]}),e.jsxs(f,{value:a.status,onValueChange:I,children:[e.jsx(v,{className:"w-full md:w-48 border-yellow-200",children:e.jsx(C,{placeholder:"상태별 필터"})}),e.jsxs(T,{children:[e.jsx(l,{value:"all",children:"전체 상태"}),e.jsx(l,{value:"승인대기",children:"승인 대기"}),e.jsx(l,{value:"승인완료",children:"승인 완료"}),e.jsx(l,{value:"승인거부",children:"승인 거부"})]})]}),e.jsxs(f,{value:a.rating,onValueChange:k,children:[e.jsx(v,{className:"w-full md:w-48 border-yellow-200",children:e.jsx(C,{placeholder:"평점별 필터"})}),e.jsxs(T,{children:[e.jsx(l,{value:"all",children:"전체 평점"}),e.jsx(l,{value:"5",children:"5점"}),e.jsx(l,{value:"4",children:"4점"}),e.jsx(l,{value:"3",children:"3점"}),e.jsx(l,{value:"2",children:"2점"}),e.jsx(l,{value:"1",children:"1점"})]})]})]})})}),e.jsxs(d,{className:"shadow-lg border-0 bg-white",children:[e.jsx(W,{className:"bg-gradient-to-r from-yellow-50 to-orange-50 border-b border-yellow-100",children:e.jsx(X,{className:"text-yellow-800 flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(h,{className:"w-5 h-5 mr-2"}),"후기 목록 (",g.length,"건)"]})})}),e.jsx(o,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs($,{children:[e.jsx(J,{className:"bg-yellow-50",children:e.jsxs(b,{children:[e.jsx(c,{className:"font-semibold text-yellow-800",children:"환자 정보"}),e.jsx(c,{className:"font-semibold text-yellow-800",children:"치료 내용"}),e.jsx(c,{className:"font-semibold text-yellow-800",children:"평점"}),e.jsx(c,{className:"font-semibold text-yellow-800",children:"후기 내용"}),e.jsx(c,{className:"font-semibold text-yellow-800",children:"담당의"}),e.jsx(c,{className:"font-semibold text-yellow-800",children:"상태"}),e.jsx(c,{className:"font-semibold text-yellow-800",children:"작성일"}),e.jsx(c,{className:"font-semibold text-yellow-800",children:"관리"})]})}),e.jsx(Q,{children:g.length===0?e.jsx(b,{children:e.jsxs(r,{colSpan:8,className:"text-center py-8 text-gray-500",children:[e.jsx(w,{className:"w-8 h-8 mx-auto mb-2"}),"검색 조건에 맞는 후기가 없습니다."]})}):g.map(s=>e.jsxs(b,{className:"hover:bg-yellow-50/30",children:[e.jsx(r,{children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-yellow-100 rounded-full flex items-center justify-center text-yellow-600 font-bold",children:s.patientName.charAt(0)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:s.patientName}),e.jsx("p",{className:"text-sm text-gray-600",children:s.patientInfo})]})]})}),e.jsx(r,{children:e.jsx(S,{variant:"outline",className:"text-blue-600 border-blue-200",children:s.service})}),e.jsx(r,{children:D(s.rating)}),e.jsx(r,{className:"max-w-xs",children:e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:s.content})}),e.jsx(r,{children:e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.doctorName})}),e.jsx(r,{children:e.jsx(S,{className:A(s.status),variant:"outline",children:s.status})}),e.jsx(r,{children:e.jsx("span",{className:"text-sm text-gray-600",children:new Date(s.createdAt).toLocaleDateString("ko-KR")})}),e.jsx(r,{children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(j,{size:"sm",variant:"outline",className:"border-gray-300",onClick:()=>M(s),children:e.jsx(H,{className:"w-3 h-3"})}),s.status==="승인대기"&&e.jsxs(e.Fragment,{children:[e.jsx(j,{size:"sm",className:"bg-green-600 hover:bg-green-700 text-white",onClick:()=>P(s.id),children:e.jsx(y,{className:"w-3 h-3"})}),e.jsx(j,{size:"sm",variant:"outline",className:"border-red-300 text-red-600 hover:bg-red-50",onClick:()=>V(s),children:e.jsx(q,{className:"w-3 h-3"})})]})]})})]},s.id))})]})})})]})]})}export{ae as default};
